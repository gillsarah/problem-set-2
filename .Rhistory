0.095321932,
0.108595989,
0.124343832,
0.133827684,
0.158180301,
0.166374012,
0.203763441,
0.249670619,
0.264664804,
0.260660248,
0.32616179,
0.375992063,
0.446933962,
0.493489583,
0.54454023,
0.684115523))
#library("tidyverse")
library("ggplot")
#library("tidyverse")
library("ggplot2")
summary(demand_modelA)
demand <- data.frame('price'= c(250,350,450))
View(demand)
demand <- data.frame('price'= c(250,350,450), 'Q1'= c(2047, 1020, 502),
'Q2'= c(2214,1195,549))
View(demand)
ggplot(data = demand) +
geom_point(aes(x='Q1', y='price'))
ggplot(data = demand) +
geom_point(aes(x='Q1', y='price'))
ggplot(data = demand) +
geom_point(aes(x=Q1, y=price))
ggplot(data = demand) +
geom_point(aes(x=Q1, y=price, color = "blue"))
ggplot(data = demand) +
geom_point(aes(x=Q1, y=price))+
geom_point(aes(x=Q2, y=price))
ggplot(data = demand) +
geom_point(aes(x=Q1, y=price, colour = 'b'))+
geom_point(aes(x=Q2, y=price))
ggplot(data = demand) +
geom_line(aes(x=Q1, y=price, colour = 'b'))+
geom_point(aes(x=Q2, y=price))
ggplot(data = demand) +
geom_line(aes(x=Q1, y=price, colour = 'b'))+
geom_line(aes(x=Q2, y=price))
ggplot(data = demand) +
geom_line(aes(x=Q1, y=price, colours = True))+
geom_line(aes(x=Q2, y=price))
ggplot(data = demand) +
geom_line(aes(x=Q1, y=price, colours = blue))+
geom_line(aes(x=Q2, y=price))
ggplot(data = demand) +
geom_line(aes(x=Q1, y=price, colour = blue9))+
geom_line(aes(x=Q2, y=price))
ggplot(data = demand) +
geom_line(aes(x=Q1, y=price, colour = blue))+
geom_line(aes(x=Q2, y=price))
geom_line(aes(x=Q2, y=price))
ggplot(data = demand) +
geom_line(aes(x=Q1, y=price, color='darkblue')) +
geom_line(aes(x=Q2, y=price))
ggplot(data = demand) +
geom_line(aes(x=Q1, y=price)) +
geom_line(color='darkblue')+
geom_line(aes(x=Q2, y=price))
ggplot(data = demand) +
geom_line(aes(x=Q1, y=price, color = Q1)) +
geom_line(aes(x=Q2, y=price))
ggplot(data = demand) +
geom_line(aes(x=Q1, y=price, color = 'blue')) +
geom_line(aes(x=Q2, y=price))
ggplot(data = demand) +
geom_line(aes(x=Q1, y=price, color = 'blue')) +
geom_line(aes(x=Q2, y=price, color = 'red'))
ggplot(data = demand) +
geom_line(aes(x=Q1, y=price) color = 'blue') +
geom_line(aes(x=Q2, y=price) color = 'red') +
labs(x = "Q", y = "Price")
ggplot(data = demand) +
geom_line(aes(x=Q1, y=price), color = 'blue') +
geom_line(aes(x=Q2, y=price), color = 'red') +
labs(x = "Q", y = "Price")
ggplot(data = demand) +
geom_line(aes(x=Q1, y=price), color = 'blue') +
geom_line(aes(x=Q2, y=price), color = 'red') +
geom_line(aes(x=Q3, y=price), color = 'darkblue') +
geom_line(aes(x=Q4, y=price), color = 'darkred') +
labs(x = "Q", y = "Price")
demand <- data.frame('price'= c(250,350,450), 'Q1'= c(2047, 1020, 502),
'Q2'= c(2214,1195,549), 'Q3'= c(2383,1314,679),
'Q4'= c(2343,1319653))
demand <- data.frame('price'= c(250,350,450), 'Q1'= c(2047, 1020, 502),
'Q2'= c(2214,1195,549), 'Q3'= c(2383,1314,679),
'Q4'= c(2343,1319,653))
ggplot(data = demand) +
geom_line(aes(x=Q1, y=price), color = 'blue') +
geom_line(aes(x=Q2, y=price), color = 'red') +
geom_line(aes(x=Q3, y=price), color = 'darkblue') +
geom_line(aes(x=Q4, y=price), color = 'darkred') +
labs(x = "Q", y = "Price")
ggplot(data = demand) +
geom_line(aes(x=Q1, y=price, label = "1"), color = 'blue') +
geom_line(aes(x=Q2, y=price), color = 'red') +
geom_line(aes(x=Q3, y=price), color = 'darkblue') +
geom_line(aes(x=Q4, y=price), color = 'darkred') +
labs(x = "Q", y = "Price")
ggplot(data = demand) +
geom_line(aes(x=Q1, y=price, color = 'Q1'), color = 'blue') +
geom_line(aes(x=Q2, y=price), color = 'red') +
geom_line(aes(x=Q3, y=price), color = 'darkblue') +
geom_line(aes(x=Q4, y=price), color = 'darkred') +
labs(x = "Q", y = "Price")
ggplot(data = demand) +
geom_line(aes(x=Q1, y=price, color = 'Q1')) +
geom_line(aes(x=Q2, y=price), color = 'red') +
geom_line(aes(x=Q3, y=price), color = 'darkblue') +
geom_line(aes(x=Q4, y=price), color = 'darkred') +
labs(x = "Q", y = "Price")
ggplot(data = demand) +
geom_line(aes(x=Q1, y=price, color = 'one firm')) +
geom_line(aes(x=Q2, y=price), color = 'red') +
geom_line(aes(x=Q3, y=price), color = 'darkblue') +
geom_line(aes(x=Q4, y=price), color = 'darkred') +
labs(x = "Q", y = "Price")
ggplot(data = demand) +
geom_line(aes(x=Q1, y=price, color = '1 firm')) +
geom_line(aes(x=Q2, y=price, color = '2 firms')) +
geom_line(aes(x=Q3, y=price, color = '3 firms')) +
geom_line(aes(x=Q4, y=price, color = '4 firms')) +
labs(x = "Q", y = "Price")
labs(x = "Q", y = "Price")
ggplot(data = demand) +
geom_line(aes(x=Q1, y=price, color = '1 firm')) +
geom_line(aes(x=Q2, y=price, color = '2 firms')) +
geom_line(aes(x=Q3, y=price, color = '3 firms')) +
geom_line(aes(x=Q4, y=price, color = '4 firms')) +
abline(h = 235.5) +
labs(x = "Q", y = "Price")
ggplot(data = demand) +
geom_line(aes(x=Q1, y=price, color = '1 firm')) +
geom_line(aes(x=Q2, y=price, color = '2 firms')) +
geom_line(aes(x=Q3, y=price, color = '3 firms')) +
geom_line(aes(x=Q4, y=price, color = '4 firms')) +
geom_hline(235.5) +
labs(x = "Q", y = "Price")
ggplot(data = demand) +
geom_line(aes(x=Q1, y=price, color = '1 firm')) +
geom_line(aes(x=Q2, y=price, color = '2 firms')) +
geom_line(aes(x=Q3, y=price, color = '3 firms')) +
geom_line(aes(x=Q4, y=price, color = '4 firms')) +
geom_hline(aes(235.5)) +
labs(x = "Q", y = "Price")
ggplot(data = demand) +
geom_line(aes(x=Q1, y=price, color = '1 firm')) +
geom_line(aes(x=Q2, y=price, color = '2 firms')) +
geom_line(aes(x=Q3, y=price, color = '3 firms')) +
geom_line(aes(x=Q4, y=price, color = '4 firms')) +
geom_hline(aes(yintercept = 235.5)) +
labs(x = "Q", y = "Price")
model1 <- lm(price~Q1, data = demand)
model1 <- lm(price~Q1+I(Q1^2), data = demand)
pred_df <- data.frame(price_pred = predict(model1, demand), Q1=demand$Q1)
View(pred_df)
ggplot(data = demand) +
geom_point(aes(x=Q1, y=price, color = '1 firm')) +
geom_line(color='red',data = pred_df, aes(x=price_pred, y=Q1))
ggplot(data = demand) +
geom_point(aes(x=Q1, y=price, color = '1 firm')) +
geom_line(color='red',data = pred_df, aes(x=Q1,y=price_pred))
ggplot(data = demand) +
geom_point(aes(x=Q1, y=price, color = '1 firm')) +
geom_line(color='red',data = pred_df, aes(x=Q1,y=price_pred))+
geom_line(aes(x=Q2, y=price, color = '2 firms')) +
geom_line(aes(x=Q3, y=price, color = '3 firms')) +
geom_line(aes(x=Q4, y=price, color = '4 firms')) +
geom_hline(aes(yintercept = 235.5)) +
labs(x = "Q", y = "Price")
pred_df <- data.frame(price_pred = predict(model1, demand), Q1=c(450,350,250,150))
pred_df <- data.frame(price_pred = predict(model1), Q1=c(450,350,250,150))
ggplot(data = demand) +
geom_point(aes(x=Q1, y=price, color = '1 firm')) +
geom_line(color='red',data = pred_df, aes(x=Q1,y=price_pred))+
geom_line(aes(x=Q2, y=price, color = '2 firms')) +
geom_line(aes(x=Q3, y=price, color = '3 firms')) +
geom_line(aes(x=Q4, y=price, color = '4 firms')) +
geom_hline(aes(yintercept = 235.5)) +
labs(x = "Q", y = "Price")
View(pred_df)
pred_df <- data.frame(price_pred = predict(model1,c(450,350,250,150) ), Q1=c(450,350,250,150))
pred_df <- data.frame(price_pred = predict(model1, c(450,350,250,150)), Q1=c(450,350,250,150))
ggplot(data = demand) +
geom_point(aes(x=Q1, y=price, color = '1 firm')) +
geom_line(color='red',data = pred_df, aes(x=Q1,y=price_pred))+
geom_line(aes(x=Q2, y=price, color = '2 firms')) +
geom_line(aes(x=Q3, y=price, color = '3 firms')) +
geom_line(aes(x=Q4, y=price, color = '4 firms')) +
geom_hline(aes(yintercept = 235.5)) +
labs(title = 'demand with 1-4 firms in the mkt',x = "Q", y = "Price")
demandA <- data.frame('price'= c(250,350,450), 'Q1'= c(2047, 1020, 502),
'Q2'= c(2214,1195,549), 'Q3'= c(2383,1314,679),
'Q4'= c(2343,1319,653))
ggplot(data = demand) +
geom_point(aes(x=Q1, y=price, color = '1 firm')) +
geom_line(color='red',data = pred_df, aes(x=Q1,y=price_pred))+
geom_line(aes(x=Q2, y=price, color = '2 firms')) +
geom_line(aes(x=Q3, y=price, color = '3 firms')) +
geom_line(aes(x=Q4, y=price, color = '4 firms')) +
geom_hline(aes(yintercept = 235.5)) +
labs(title = 'demand with 1-4 firms mkt A',x = "Q", y = "Price")
demandC <- data.frame('price'= c(100,200,300), 'Q1'= c(427, 268, 182),
'Q2'= c(467,357,268), 'Q3'= c(496,376 ,261),
'Q4'= c(509,367,300))
ggplot(data = demandC) +
geom_line(aes(x=Q1, y=price, color = '1 firm')) +
#geom_line(color='red',data = pred_df, aes(x=Q1,y=price_pred))+
geom_line(aes(x=Q2, y=price, color = '2 firms')) +
geom_line(aes(x=Q3, y=price, color = '3 firms')) +
geom_line(aes(x=Q4, y=price, color = '4 firms')) +
geom_hline(aes(yintercept = 235.5)) +
labs(title = 'demand with 1-4 firms mkt C',x = "Q", y = "Price")
ggplot(data = demandC) +
geom_line(aes(x=Q1, y=price, color = '1 firm')) +
#geom_line(color='red',data = pred_df, aes(x=Q1,y=price_pred))+
geom_line(aes(x=Q2, y=price, color = '2 firms')) +
geom_line(aes(x=Q3, y=price, color = '3 firms')) +
geom_line(aes(x=Q4, y=price, color = '4 firms')) +
geom_hline(aes(yintercept = 213.33)) +
labs(title = 'demand with 1-4 firms mkt C',x = "Q", y = "Price")
ggplot(data = demandC) +
geom_line(aes(x=Q1, y=price, color = '1 firm')) +
#geom_line(color='red',data = pred_df, aes(x=Q1,y=price_pred))+
geom_line(aes(x=Q2, y=price, color = '2 firms')) +
geom_line(aes(x=Q3, y=price, color = '3 firms')) +
geom_line(aes(x=Q4, y=price, color = '4 firms')) +
geom_line(aes(y=(196.33/Q1)+17, x = Q1)) +
labs(title = 'demand with 1-4 firms mkt C',x = "Q", y = "Price")
ggplot(data = demandC) +
geom_line(aes(x=Q1, y=price, color = '1 firm')) +
#geom_line(color='red',data = pred_df, aes(x=Q1,y=price_pred))+
geom_line(aes(x=Q2, y=price, color = '2 firms')) +
geom_line(aes(x=Q3, y=price, color = '3 firms')) +
geom_line(aes(x=Q4, y=price, color = '4 firms')) +
geom_line(aes(y=(196.33/Q1)+17, x = Q1, color='AVC?')) +
labs(title = 'demand with 1-4 firms mkt C',x = "Q", y = "Price")
ggplot(data = demandC) +
geom_line(aes(x=Q1, y=price, color = '1 firm')) +
#geom_line(color='red',data = pred_df, aes(x=Q1,y=price_pred))+
geom_line(aes(x=Q2, y=price, color = '2 firms')) +
geom_line(aes(x=Q3, y=price, color = '3 firms')) +
geom_line(aes(x=Q4, y=price, color = '4 firms')) +
geom_line(aes(y=(196.33/Q1), x = Q1, color='AVC?')) +
labs(title = 'demand with 1-4 firms mkt C',x = "Q", y = "Price")
ggplot(data = demandC) +
geom_line(aes(x=Q1, y=price, color = '1 firm')) +
#geom_line(color='red',data = pred_df, aes(x=Q1,y=price_pred))+
geom_line(aes(x=Q2, y=price, color = '2 firms')) +
geom_line(aes(x=Q3, y=price, color = '3 firms')) +
geom_line(aes(x=Q4, y=price, color = '4 firms')) +
geom_line(aes(y=(196.33/Q1)+17, x = Q1, color='AVC?')) +
labs(title = 'demand with 1-4 firms mkt C',x = "Q", y = "Price")
entryc_over_life <- 83762/10
ggplot(data = demandC) +
geom_line(aes(x=Q1, y=price, color = '1 firm')) +
#geom_line(color='red',data = pred_df, aes(x=Q1,y=price_pred))+
geom_line(aes(x=Q2, y=price, color = '2 firms')) +
geom_line(aes(x=Q3, y=price, color = '3 firms')) +
geom_line(aes(x=Q4, y=price, color = '4 firms')) +
geom_line(aes(y=((entryc_over_life+196.33)/Q1)+17, x = Q1, color='AVC?')) +
labs(title = 'demand with 1-4 firms mkt C',x = "Q", y = "Price")
capital_cost_per_period <- 589/3
ggplot(data = demandC) +
geom_line(aes(x=Q1, y=price, color = '1 firm')) +
#geom_line(color='red',data = pred_df, aes(x=Q1,y=price_pred))+
geom_line(aes(x=Q2, y=price, color = '2 firms')) +
geom_line(aes(x=Q3, y=price, color = '3 firms')) +
geom_line(aes(x=Q4, y=price, color = '4 firms')) +
geom_line(aes(y=((entryc_over_life+capital_cost_per_period)/Q1)+17, x = Q1, color='AVC?')) +
labs(title = 'demand with 1-4 firms mkt C',x = "Q", y = "Price")
labs(title = 'demand with 1-4 firms mkt C',x = "Q", y = "Price")
ggplot(data = demandC) +
geom_line(aes(x=Q1, y=price, color = '1 firm')) +
#geom_line(color='red',data = pred_df, aes(x=Q1,y=price_pred))+
geom_line(aes(x=Q2, y=price, color = '2 firms')) +
geom_line(aes(x=Q3, y=price, color = '3 firms')) +
geom_line(aes(x=Q4, y=price, color = '4 firms')) +
geom_line(aes(y=(entryc_over_life)/Q1+capital_cost_per_period+17, x = Q1, color='AVC?')) +
labs(title = 'demand with 1-4 firms mkt C',x = "Q", y = "Price")
entryc_over_life <- 47627/10
capital_cost_per_period <-758/4
MC <-46
ggplot(data = demandA) +
geom_point(aes(x=Q1, y=price, color = '1 firm')) +
geom_line(color='red',data = pred_df, aes(x=Q1,y=price_pred))+
geom_line(aes(x=Q2, y=price, color = '2 firms')) +
geom_line(aes(x=Q3, y=price, color = '3 firms')) +
geom_line(aes(x=Q4, y=price, color = '4 firms')) +
geom_hline(aes(yintercept = 235.5)) +
geom_line(aes(y=(entryc_over_life)/Q1+capital_cost_per_period+MC, x = Q1, color='AVC?')) +
labs(title = 'demand with 1-4 firms mkt A',x = "Q", y = "Price")
def my_func()
def my_func
def myfunc
plot <- function(data, FC, CC, MC){
ggplot(data = data) +
geom_line(aes(x=Q1, y=price, color = '1 firm')) +
#geom_line(color='red',data = pred_df, aes(x=Q1,y=price_pred))+
geom_line(aes(x=Q2, y=price, color = '2 firms')) +
geom_line(aes(x=Q3, y=price, color = '3 firms')) +
geom_line(aes(x=Q4, y=price, color = '4 firms')) +
geom_line(aes(y=(FC)/Q1+CC+MC, x = Q1, color='AVC?')) +
labs(title = 'demand with 1-4 firms the mkt',x = "Q", y = "Price")
}
plot(demandC,83762/10,589/3,17)
demand_model2 = lm(Quantity~Price + I(Price^2), data = D_C)
summary(demand_model2)
demand_model_lin = lm(Price~Quantity, data = D_C)
summary(demand_model_lin)
entryc_over_life <- 47627/10
capital_cost_per_period <-758/4
MC <-46
ggplot(data = demandA) +
geom_point(aes(x=Q1, y=price, color = '1 firm')) +
geom_line(color='red',data = pred_df, aes(x=Q1,y=price_pred))+
geom_line(aes(x=Q2, y=price, color = '2 firms')) +
geom_line(aes(x=Q3, y=price, color = '3 firms')) +
geom_line(aes(x=Q4, y=price, color = '4 firms')) +
geom_hline(aes(yintercept = 235.5)) +
geom_line(aes(y=(entryc_over_life)/Q1+capital_cost_per_period+MC, x = Q1, color='AVC?')) +
labs(title = 'demand with 1-4 firms mkt A',x = "Q", y = "Price")
setwd("~/Documents/GitHub/problem-set-2")
knitr::opts_chunk$set(echo = TRUE)
setwd("~/Documents/GitHub/problem-set-2")
library(readr)
nes2008_df <- read_csv("nes2008.csv")
regn_model <- lm(biden~famale+age+educ+dem+rep, data = nes2008_df)
nes2008_df <- read_csv("nes2008.csv")
regn_model <- lm(biden~female+age+educ+dem+rep, data = nes2008_df)
summary(regn_model)
demand_model_lin = lm(Price~Quantity, data = D_C)
summary(demand_model_lin)
plot(demandC,83762/10,589/3,17)
entryc_over_life <- 47627/10
capital_cost_per_period <-758/4
MC <-46
ggplot(data = demandA) +
geom_point(aes(x=Q1, y=price, color = '1 firm')) +
geom_line(color='red',data = pred_df, aes(x=Q1,y=price_pred))+
geom_line(aes(x=Q2, y=price, color = '2 firms')) +
geom_line(aes(x=Q3, y=price, color = '3 firms')) +
geom_line(aes(x=Q4, y=price, color = '4 firms')) +
geom_hline(aes(yintercept = 235.5)) +
geom_line(aes(y=(entryc_over_life)/Q1+capital_cost_per_period+MC, x = Q1, color='AVC?')) +
labs(title = 'demand with 1-4 firms mkt A',x = "Q", y = "Price")
demandB <- data.frame('price'= c(200,400,600), 'Q1'= c(7822,4833, 2688),
'Q2'= c(8297,5475,3188), 'Q3'= c(8485,5636 ,3549),
'Q4'= c(8486,5944,3737))
plot(demandC, 50636/10, 51/10,285)
plot <- function(data, FC, CC, MC){
ggplot(data = data) +
geom_line(aes(x=Q1, y=price, color = '1 firm')) +
#geom_line(color='red',data = pred_df, aes(x=Q1,y=price_pred))+
geom_line(aes(x=Q2/2, y=price, color = '2 firms')) +
geom_line(aes(x=Q3/3, y=price, color = '3 firms')) +
geom_line(aes(x=Q4/4, y=price, color = '4 firms')) +
geom_line(aes(y=(FC)/Q1+CC+MC, x = Q1, color='AVC?')) +
labs(title = 'demand with 1-4 firms the mkt',x = "Q", y = "Price")
}
plot(demandC, 50636/10, 51/10,285)
plot(demandC,83762/10,589/3,17)
plot(demandA,entryc_over_life, capital_cost_per_period, MC)
plot(demandC, 50636/10, 51/10,285)
plot(demandB, 50636/10, 51/10,285)
demand_model2 = lm(Quantity~Price + I(Price^2), data = D_C)
summary(demand_model2)
demand_model_lin = lm(Quantity~Price, data = D_C)
summary(demand_model_lin)
demand_modelA = lm(Quantity~Price + I(Price^2), data = D_A)
summary(demand_modelA)
D_B = read_xls(file.choose(), sheet = 2)
View(D_B)
D_B = read_xls(file.choose(), sheet = 2)
View(D_B)
demand_modelB = lm(Quantity~Price + I(Price^2), data = D_B)
summary(demand_modelB)
D_D = read_xls(file.choose(),sheet = 4)
demand_modelD = lm(Quantity~Price + I(Price^2), data = D_D)
summary(demand_modelD)
demand_modelA = lm(Quantity~Price + I(Price^2), data = D_A)
summary(demand_modelA)
demand_modelB = lm(Quantity~Price + I(Price^2), data = D_B)
summary(demand_modelB)
demand_modelD = lm(Quantity~Price + I(Price^2), data = D_D)
summary(demand_modelD)
d = lm(Quantity~Price, data = D_D)
summayr(d)
d = lm(Quantity~Price, data = D_D)
summary(d)
plot(demandB, 50636/10, 51/10,285)
plot(demandA,entryc_over_life, capital_cost_per_period, MC)
install.packages(rsample)
install.packages(yardstick)
install.packages("rsample")
install.packages("yardstick")
install.packages("rcfss")
knitr::opts_chunk$set(echo = TRUE)
library(rcfss)
devtools:: install_github("uc-cfss/rcfss") #how install for stuff not on cran
install.packages("devtools")
install.packages("devtools")
install.packages("broom")
knitr::opts_chunk$set(echo = TRUE)
setwd("~/Documents/GitHub/problem-set-2")
library(readr)
library(rcfss)
library(boot)
library(tidyverse)
library(broom)
set.seed(1234)
nes2008_df <- read_csv("nes2008.csv")
regn_model <- glm(biden~female+age+educ+dem+rep, data = nes2008_df)
summary(regn_model)
(mse <- augment(regn_model, newdata = nes2008_df) %>%
mse(truth = biden, estimate = .fitted))
broom::tidy()
regn_model <- lm(biden ~ female + age + educ + dem + rep, data = nes2008_df)
tidy(regn_model)
# bootstrapped estimates of the parameter estimates and standard errors
lm_coefs <- function(splits, ...) {
## use `analysis` or `as.data.frame` to get the analysis data
mod <- lm(..., data = analysis(splits))
tidy(mod)
#summary(mod)
}
biden_boot <- nes2008_df %>%
bootstraps(1000) %>%
mutate(coef = map(splits, lm_coefs, as.formula(biden ~ female + age + educ + dem + rep)))
library(ISLR)
broom::tidy()
library(ISLR)
regn_model <- lm(biden ~ female + age + educ + dem + rep, data = nes2008_df)
tidy(regn_model)
# bootstrapped estimates of the parameter estimates and standard errors
lm_coefs <- function(splits, ...) {
## use `analysis` or `as.data.frame` to get the analysis data
mod <- lm(..., data = analysis(splits))
tidy(mod)
#summary(mod)
}
biden_boot <- nes2008_df %>%
bootstraps(1000) %>%
mutate(coef = map(splits, lm_coefs, as.formula(biden ~ female + age + educ + dem + rep)))
knitr::opts_chunk$set(echo = TRUE)
mse <- function(data, ...) {
UseMethod("mse")
}
#' @export
#' @rdname mse
mse.data.frame <- function(data, truth, estimate, na_rm = TRUE, ...) {
metric_summarizer(
metric_nm = "mse",
metric_fn = mse_vec,
data = data,
truth = !! rlang::enquo(truth),
estimate = !! rlang::enquo(estimate),
na_rm = na_rm,
...
)
}
knitr::opts_chunk$set(echo = TRUE)
setwd("~/Documents/GitHub/problem-set-2")
mse <- function(data, ...) {
UseMethod("mse")
}
#' @export
#' @rdname mse
mse.data.frame <- function(data, truth, estimate, na_rm = TRUE, ...) {
metric_summarizer(
metric_nm = "mse",
metric_fn = mse_vec,
data = data,
truth = !! rlang::enquo(truth),
estimate = !! rlang::enquo(estimate),
na_rm = na_rm,
...
)
}
nes2008_df <- read_csv("nes2008.csv")
regn_model <- glm(biden~female+age+educ+dem+rep, data = nes2008_df)
summary(regn_model)
(mse <- augment(regn_model, newdata = nes2008_df) %>%
mse(truth = biden, estimate = .fitted))
library(dplyr)
nes2008_df <- read_csv("nes2008.csv")
regn_model <- glm(biden ~ female + age + educ + dem + rep, data = nes2008_df)
summary(regn_model)
(mse <- augment(regn_model, newdata = nes2008_df) %>%
mse(truth = biden, estimate = .fitted))
broom::tidy()
library(ISLR)
regn_model <- lm(biden ~ female + age + educ + dem + rep, data = nes2008_df)
tidy(regn_model)
# bootstrapped estimates of the parameter estimates and standard errors
lm_coefs <- function(splits, ...) {
## use `analysis` or `as.data.frame` to get the analysis data
mod <- lm(..., data = analysis(splits))
tidy(mod)
#summary(mod)
}
biden_boot <- nes2008_df %>%
bootstraps(1000) %>%
mutate(coef = map(splits, lm_coefs, as.formula(biden ~ female + age + educ + dem + rep)))
